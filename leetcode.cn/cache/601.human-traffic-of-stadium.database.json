{"id":601,"fid":"601","name":"体育馆的人流量","slug":"human-traffic-of-stadium","link":"https://leetcode-cn.com/problems/human-traffic-of-stadium/description/","percent":47.18647145613438,"level":"Hard","category":"database","totalAC":"20.8K","totalSubmit":"44.1K","likes":154,"dislikes":0,"desc":"表：<code>Stadium</code>\n<div class=\"original__bRMd\">\n<div>\n<pre>\n+---------------+---------+\n| Column Name   | Type    |\n+---------------+---------+\n| id            | int     |\n| visit_date    | date    |\n| people        | int     |\n+---------------+---------+\nvisit_date 是表的主键\n每日人流量信息被记录在这三列信息中：<strong>序号</strong> (id)、<strong>日期</strong> (visit_date)、 <strong>人流量</strong> (people)\n每天只有一行记录，日期随着 id 的增加而增加\n</pre>\n\n<p> </p>\n\n<p class=\"MachineTrans-lang-zh-CN\">编写一个 SQL 查询以找出每行的人数大于或等于 <code>100</code> 且 <code>id</code> 连续的三行或更多行记录。</p>\n\n<p class=\"MachineTrans-lang-zh-CN\">返回按 <code>visit_date</code> 升序排列的结果表。</p>\n\n<p class=\"MachineTrans-lang-zh-CN\">查询结果格式如下所示。</p>\n\n<pre>\n<code>Stadium</code> table:\n+------+------------+-----------+\n| id   | visit_date | people    |\n+------+------------+-----------+\n| 1    | 2017-01-01 | 10        |\n| 2    | 2017-01-02 | 109       |\n| 3    | 2017-01-03 | 150       |\n| 4    | 2017-01-04 | 99        |\n| 5    | 2017-01-05 | 145       |\n| 6    | 2017-01-06 | 1455      |\n| 7    | 2017-01-07 | 199       |\n| 8    | 2017-01-09 | 188       |\n+------+------------+-----------+\n\nResult table:\n+------+------------+-----------+\n| id   | visit_date | people    |\n+------+------------+-----------+\n| 5    | 2017-01-05 | 145       |\n| 6    | 2017-01-06 | 1455      |\n| 7    | 2017-01-07 | 199       |\n| 8    | 2017-01-09 | 188       |\n+------+------------+-----------+\n<strong>id</strong> 为 5、6、7、8 的四行 id 连续，并且每行都有 >= 100 的人数记录。\n请注意，即使第 7 行和第 8 行的 visit_date 不是连续的，输出也应当包含第 8 行，因为我们只需要考虑 id 连续的记录。\n不输出 id 为 2 和 3 的行，因为至少需要三条 id 连续的记录。\n</pre>\n</div>\n</div>\n","templates":[{"value":"mysql","text":"MySQL","defaultCode":"# Write your MySQL query statement below"},{"value":"mssql","text":"MS SQL Server","defaultCode":"/* Write your T-SQL query statement below */"},{"value":"oraclesql","text":"Oracle","defaultCode":"/* Write your PL/SQL query statement below */"}],"testcase":"{\"headers\": {\"stadium\": [\"id\", \"visit_date\", \"people\"]}, \"rows\": {\"stadium\": [[1, \"2017-01-01\", 10], [2, \"2017-01-02\", 109], [3, \"2017-01-03\", 150], [4, \"2017-01-04\", 99], [5, \"2017-01-05\", 145], [6, \"2017-01-06\", 1455], [7, \"2017-01-07\", 199], [8, \"2017-01-09\", 188]]}}","testable":true,"templateMeta":{"mysql":["Create table If Not Exists stadium (id int, visit_date DATE NULL, people int)"],"mssql":["Create table stadium (id int, visit_date DATE NULL, people int)"],"oraclesql":["Create table stadium (id int, visit_date DATE, people int)","ALTER SESSION SET nls_date_format='YYYY-MM-DD'"],"database":true}}